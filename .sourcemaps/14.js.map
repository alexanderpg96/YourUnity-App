{"version":3,"sources":["../../src/pages/cards/cards.module.ts","../../src/pages/cards/cards.ts"],"names":[],"mappings":"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","file":"14.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { IonicPageModule } from 'ionic-angular';\n\nimport { CardsPage } from './cards';\n\n@NgModule({\n  declarations: [\n    CardsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(CardsPage),\n    TranslateModule.forChild()\n  ],\n  exports: [\n    CardsPage\n  ]\n})\nexport class CardsPageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/cards/cards.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController } from 'ionic-angular';\nimport { Http } from '@angular/http';\nimport {HttpModule, Headers, RequestOptions, Response} from '@angular/http'\nimport 'rxjs/add/operator/map';\nimport { Observable } from 'rxjs/Observable';\nimport { Storage } from '@ionic/storage';\nimport { Platform } from 'ionic-angular';\nimport { NativeGeocoder, NativeGeocoderReverseResult, NativeGeocoderForwardResult } from '@ionic-native/native-geocoder';\n\nimport firebase from 'firebase';\n\n@IonicPage()\n@Component({\n  selector: 'page-cards',\n  templateUrl: 'cards.html'\n})\nexport class CardsPage {\n  cardItems: any[];\n  eventOpened: Boolean = false;\n  isRegister: Boolean = true;\n  user = firebase.auth().currentUser;\n  ios: Boolean;\n  latitude : any;\n  longitude : any;\n  userLat: any;\n  userLong: any;\n  distance: number;\n\n  constructor(public navCtrl: NavController, public http: Http, public storage: Storage, public platform: Platform, private nativeGeocoder: NativeGeocoder) {\n    this.http.get('https://yourunity-dev.dev/api/events/').map(res => res.json()).subscribe(data => {\n      this.cardItems = data;\n      \n      for(var i = 0; i < this.cardItems.length; i++) {\n        var item = this.cardItems[i];\n\n        this.nativeGeocoder.forwardGeocode(item.location).then((coordinates: NativeGeocoderForwardResult) => {\n          item.latitude = coordinates.latitude;\n          item.longitude = coordinates.longitude;\n        }).catch((error: any) => console.log(error));\n\n        item.distance = this.calculateDistance(this.userLat, item.latitude, this.userLong, item.longitude);\n      }\n    });\n\n    if (this.platform.is('ios')) {\n      this.ios = true;\n    }\n    else {\n      this.ios = false;\n    }\n\n  }\n\n  calculateDistance(lat1:number,lat2:number,long1:number,long2:number){\n    let p = 0.017453292519943295;    // Math.PI / 180\n    let c = Math.cos;\n    let a = 0.5 - c((lat1-lat2) * p) / 2 + c(lat2 * p) *c((lat1) * p) * (1 - c(((long1- long2) * p))) / 2;\n    let dis = (12742 * Math.asin(Math.sqrt(a))); // 2 * R; R = 6371 km\n    dis = Math.round( ((dis)) * 10 ) / 10;\n    return dis;\n  }\n\n  register(item) {\n    var user_id = this.user.uid;\n    var url = 'https://yourunity-dev.dev/api/register_event';\n    var data = {\n      \"event_id\" : item.id,\n      \"firedb_id\" : user_id,\n      \"check_in_time\" : 0,\n      \"duration\" : 0,\n      \"activity_status\" : 2\n    };\n\n    let headers = new Headers ({ 'Content-Type': 'application/json' });\n    let options = new RequestOptions({ headers: headers }); \n\n    // Check in user on server\n    this.http.post(url, JSON.stringify(data), options)\n    .map(res => res.json())\n    .subscribe(data =>\n      console.log(data)\n    );\n\n    console.log(\"uploaded\");\n\n    item.isRegister = false;\n\n    this.storage.set(item.id.toString(), \"registered\");\n  }\n\n  openEvent(item) {\n    this.storage.get(item.id.toString()).then((val) => {\n      if(val) {\n        item.isRegister = false;\n      }\n      else {\n        item.isRegister = true;\n      }      \n    }); \n\n    item.eventOpened = !item.eventOpened;\n    this.eventOpened = !this.eventOpened;\n\n    // this.navCtrl.push('EventDetailPage', {\n    //   event: event\n    // });\n  }\n\n  isOpened() {\n    return this.eventOpened;\n  }\n\n  isCardOpened(item) {\n    return item.eventOpened;\n  }\n\n  canRegister(item) {\n    return item.isRegister;\n  }\n\n  doRefresh(refresher) {\n    this.http.get('https://yourunity-dev.dev/api/events').map(res => res.json()).subscribe(data => {\n      this.cardItems = data;\n      \n      for(var i = 0; i < this.cardItems.length; i++) {\n        var item = this.cardItems[i];\n        this.storage.get(item.id.toString()).then((val) => {\n          if(val) {\n            this.setRegister(item, false);\n          }\n          else {\n            this.setRegister(item, true);\n          }      \n        }); \n\n        this.nativeGeocoder.forwardGeocode(item.location).then((coordinates: NativeGeocoderForwardResult) => {\n          item.latitude = coordinates.latitude;\n          item.longitude = coordinates.longitude;\n        }).catch((error: any) => console.log(error));\n\n        item.distance = this.calculateDistance(this.userLat, item.latitude, this.userLong, item.longitude);\n      }\n    });\n\n    setTimeout(() => {\n      console.log('Async operation has ended');\n      refresher.complete();\n    }, 700);\n  }\n\n  private setRegister(item, isIt) {\n    console.log(\"Function called on ID \" + item.id + \", value = \" + isIt);\n    item.isRegister = isIt;\n    console.log(item.isRegister);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/cards/cards.ts"],"sourceRoot":""}