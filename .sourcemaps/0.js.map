{"version":3,"sources":["../../src/pages/your-cards/your-cards.module.ts","../../src/pages/your-cards/your-cards.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { IonicPageModule } from 'ionic-angular';\n\nimport { YourCardsPage } from './your-cards';\n\n@NgModule({\n  declarations: [\n    YourCardsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(YourCardsPage),\n    TranslateModule.forChild()\n  ],\n  exports: [\n    YourCardsPage\n  ]\n})\nexport class YourCardsPageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/your-cards/your-cards.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController } from 'ionic-angular';\nimport { Http } from '@angular/http';\nimport {HttpModule, Headers, RequestOptions, Response} from '@angular/http'\nimport 'rxjs/add/operator/map';\nimport { Observable } from 'rxjs/Observable';\nimport { Storage } from '@ionic/storage';\n\nimport firebase from 'firebase';\n\n@IonicPage()\n@Component({\n  selector: 'page-your-cards',\n  templateUrl: 'your-cards.html'\n})\nexport class YourCardsPage {\n  cardItems: any[];\n  opened: Boolean = false;\n  isInEnabled: Boolean = false;\n  isOutEnabled: Boolean = false;\n  user = firebase.auth().currentUser;\n  checkin: any;\n\n\n  constructor(public navCtrl: NavController, public http: Http, public storage: Storage) {\n    this.http.get('https://yourunity-dev.dev/api/user_events/' + this.user.uid).map(res => res.json()).subscribe(data => {\n      this.cardItems = data;\n      \n      for(var i = 0; i < this.cardItems.length; i++) {\n        var item = this.cardItems[i];\n\n        // if statement to check if time has started and check status (1 = event started, 2 = not started)\n        if(item.starts <= Math.round((new Date()).getTime() / 1000) && item.ends >= Math.round((new Date()).getTime() / 1000)) {\n          storage.get(item.id.toString()).then((val) => {\n            if(val) {\n              item.isInEnabled = false;\n              item.isOutEnabled = true;\n            }\n            else {\n              item.isInEnabled = true;\n              item.isOutEnabled = false;\n            }      \n          });      \n        }\n        else {\n          item.isInEnabled = false;\n          item.isOutEnabled = false;\n        }\n      }\n\n      console.log(this.cardItems);\n      console.log(this.user.uid);\n    });\n  }\n\n  doRefresh(refresher) {\n    this.http.get('https://yourunity-dev.dev/api/user_events/' + this.user.uid).map(res => res.json()).subscribe(data => {\n      this.cardItems = data;\n      \n      for(var i = 0; i < this.cardItems.length; i++) {\n        var item = this.cardItems[i];\n\n        // if statement to check if time has started and check status (1 = event started, 2 = not started)\n        if(item.starts <= Math.round((new Date()).getTime() / 1000) && item.ends >= Math.round((new Date()).getTime() / 1000)) {\n          this.storage.get(item.id.toString()).then((val) => {\n            if(val) {\n              item.isInEnabled = false;\n              item.isOutEnabled = true;\n            }\n            else {\n              item.isInEnabled = true;\n              item.isOutEnabled = false;\n            }      \n          });      \n        }\n        else {\n          item.isInEnabled = false;\n          item.isOutEnabled = false;\n        }\n      }\n\n      console.log(this.cardItems);\n      console.log(this.user.uid);\n    });\n\n    setTimeout(() => {\n      console.log('Async operation has ended');\n      refresher.complete();\n    }, 700);\n  }\n\n  toggle(item) {\n    item.opened = !item.opened;\n  }\n\n  isCardOpened(item) {\n    return item.opened;\n  }\n\n  isCheckin(item) {\n    return item.isInEnabled;\n  }\n\n  isCheckout(item) {\n    return item.isOutEnabled;\n  }\n\n  checkIn(item) {\n    var user_id = this.user.uid;\n    var url = 'https://yourunity-dev.dev/api/checkin/' + user_id + '/' + item.id;\n    var checkinTime = Math.round((new Date()).getTime() / 1000)\n    var data = {\n      \"check_in_time\" : Math.round((new Date()).getTime() / 1000),\n      \"duration\" : 0,\n      \"activity_status\" : 1\n    };\n    let headers = new Headers ({ 'Content-Type': 'application/json' });\n    let options = new RequestOptions({ headers: headers }); \n\n    // Check in user on server\n    this.http.patch(url, JSON.stringify(data), options)\n    .map(res => res.json())\n    .subscribe(data =>\n      console.log(data)\n    );\n\n    console.log(\"uploaded\");\n\n    item.isInEnabled = false;\n    item.isOutEnabled = true;\n\n    this.storage.set(item.id.toString(), checkinTime);\n    this.storage.get(item.id.toString()).then((val) => {console.log(val)});\n  }\n\n  checkOut(item) {\n    this.storage.get(item.id.toString()).then((checkin) => {\n      var user_id = this.user.uid;\n      var url = 'https://yourunity-dev.dev/api/checkin/' + user_id + '/' + item.id;\n      var data = {\n        \"check_in_time\" : checkin,\n        \"duration\" : ((Math.round((new Date()).getTime() / 1000)) - (checkin)),\n        \"activity_status\" : 0\n      };\n      let headers = new Headers ({ 'Content-Type': 'application/json' });\n      let options = new RequestOptions({ headers: headers }); \n        \n      // Check in user on server\n      this.http.patch(url, JSON.stringify(data), options)\n      .map(res => res.json())\n      .subscribe(data =>\n        console.log(data)\n      );\n\n      console.log(\"uploaded\");\n      //console.log(((Math.round((new Date()).getTime() / 1000)) - (parseInt(item.check_in_time, 10))));\n      console.log(data);\n\n      item.isInEnabled = false;\n      item.isOutEnabled = false;\n    });\n    \n    this.storage.remove(item.id.toString());\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/your-cards/your-cards.ts"],"sourceRoot":""}